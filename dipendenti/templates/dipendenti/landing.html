{% extends 'base.html' %}

{% block title %}Accedi - Management System{% endblock %}

{% block landing_content %}
<div class="landing-hero">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-6">
                <div class="hero-content text-center">
                    <div class="login-logo mb-4">
                        <i class="fas fa-users-cog display-1"></i>
                    </div>
                    
                    <h1 class="hero-title">Management System</h1>
                    <p class="hero-subtitle">
                        Sistema di gestione modulare per la tua azienda
                    </p>
                    
                    <!-- Login Card -->
                    <div class="login-card card shadow-lg">
                        <div class="login-header">
                            <h2 class="login-title">
                                <i class="fas fa-sign-in-alt me-2"></i>
                                Accesso Sicuro
                            </h2>
                            <p class="text-muted mb-0">Inserisci le tue credenziali per continuare</p>
                        </div>
                        
                        <div class="card-body p-4">
                            <form method="post" action="{% url 'dipendenti:login' %}">
                                {% csrf_token %}
                                
                                <div class="mb-3">
                                    <label for="id_username" class="form-label">
                                        <i class="fas fa-user me-1"></i>
                                        Username o Email
                                    </label>
                                    <div class="input-group">
                                        <span class="input-group-text">
                                            <i class="fas fa-at"></i>
                                        </span>
                                        <input type="text" 
                                               class="form-control" 
                                               id="id_username" 
                                               name="username" 
                                               placeholder="Inserisci username o email" 
                                               required 
                                               autofocus>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="id_password" class="form-label">
                                        <i class="fas fa-lock me-1"></i>
                                        Password
                                    </label>
                                    <div class="input-group">
                                        <span class="input-group-text">
                                            <i class="fas fa-key"></i>
                                        </span>
                                        <input type="password" 
                                               class="form-control" 
                                               id="id_password" 
                                               name="password" 
                                               placeholder="Inserisci password" 
                                               required>
                                        <button type="button" class="btn btn-outline-secondary" onclick="togglePassword()">
                                            <i class="fas fa-eye" id="password-eye"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="mb-3 d-flex justify-content-between align-items-center">
                                    <div class="form-check">
                                        <input class="form-check-input" 
                                               type="checkbox" 
                                               id="id_remember_me" 
                                               name="remember_me">
                                        <label class="form-check-label" for="id_remember_me">
                                            Ricordami
                                        </label>
                                    </div>
                                    <a href="#" class="text-decoration-none small" onclick="showForgotPassword()">
                                        Password dimenticata?
                                    </a>
                                </div>
                                
                                <div class="d-grid">
                                    <button type="submit" class="btn btn-primary btn-lg">
                                        <i class="fas fa-sign-in-alt me-2"></i>
                                        Accedi al Sistema
                                    </button>
                                </div>
                            </form>
                        </div>
                        
                        <div class="card-footer text-center bg-transparent">
                            <small class="text-muted">
                                <i class="fas fa-shield-alt me-1"></i>
                                Connessione sicura e protetta
                            </small>
                        </div>
                    </div>
                    
                    <!-- System Info -->
                    <div class="mt-5">
                        <div class="row text-center">
                            <div class="col-md-4">
                                <div class="feature-item">
                                    <i class="fas fa-lock fa-2x mb-2"></i>
                                    <h5>Sicurezza</h5>
                                    <p class="small">Autenticazione avanzata e audit trail completo</p>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="feature-item">
                                    <i class="fas fa-cube fa-2x mb-2"></i>
                                    <h5>Modulare</h5>
                                    <p class="small">Architettura modulare per massima flessibilit√†</p>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="feature-item">
                                    <i class="fas fa-mobile-alt fa-2x mb-2"></i>
                                    <h5>Responsive</h5>
                                    <p class="small">Accessibile da qualsiasi dispositivo</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Forgot Password Modal -->
<div class="modal fade" id="forgotPasswordModal" tabindex="-1" aria-labelledby="forgotPasswordModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="forgotPasswordModalLabel">
                    <i class="fas fa-key me-2"></i>
                    Password Dimenticata
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="alert alert-info">
                    <i class="fas fa-info-circle me-2"></i>
                    <strong>Contatta l'amministratore del sistema</strong> per richiedere il reset della password.
                </div>
                
                <div class="contact-info">
                    <h6>Informazioni di Contatto:</h6>
                    <ul class="list-unstyled">
                        <li><i class="fas fa-envelope me-2"></i>admin@azienda.com</li>
                        <li><i class="fas fa-phone me-2"></i>+39 123 456 7890</li>
                        <li><i class="fas fa-clock me-2"></i>Lun-Ven: 9:00-18:00</li>
                    </ul>
                </div>
                
                <div class="security-note">
                    <small class="text-muted">
                        <i class="fas fa-shield-alt me-1"></i>
                        Per motivi di sicurezza, il reset della password deve essere autorizzato dall'amministratore.
                    </small>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-times me-1"></i>
                    Chiudi
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Toggle password visibility
    function togglePassword() {
        const passwordInput = document.getElementById('id_password');
        const passwordEye = document.getElementById('password-eye');
        
        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            passwordEye.classList.remove('fa-eye');
            passwordEye.classList.add('fa-eye-slash');
        } else {
            passwordInput.type = 'password';
            passwordEye.classList.remove('fa-eye-slash');
            passwordEye.classList.add('fa-eye');
        }
    }
    
    // Show forgot password modal
    function showForgotPassword() {
        const modal = new bootstrap.Modal(document.getElementById('forgotPasswordModal'));
        modal.show();
    }
    
    // Auto-focus on load and handle enter key
    document.addEventListener('DOMContentLoaded', function() {
        const usernameInput = document.getElementById('id_username');
        const passwordInput = document.getElementById('id_password');
        
        // Focus username field
        if (usernameInput) {
            usernameInput.focus();
        }
        
        // Handle enter key navigation
        if (usernameInput) {
            usernameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    passwordInput.focus();
                }
            });
        }
        
        // Animate login card on load
        const loginCard = document.querySelector('.login-card');
        if (loginCard) {
            loginCard.style.transform = 'translateY(20px)';
            loginCard.style.opacity = '0';
            
            setTimeout(() => {
                loginCard.style.transition = 'all 0.6s ease';
                loginCard.style.transform = 'translateY(0)';
                loginCard.style.opacity = '1';
            }, 100);
        }
        
        // Animate feature items
        const featureItems = document.querySelectorAll('.feature-item');
        featureItems.forEach((item, index) => {
            item.style.opacity = '0';
            item.style.transform = 'translateY(30px)';
            
            setTimeout(() => {
                item.style.transition = 'all 0.6s ease';
                item.style.opacity = '1';
                item.style.transform = 'translateY(0)';
            }, 200 + (index * 100));
        });
    });
    
    // Add floating animation to logo
    const logo = document.querySelector('.login-logo i');
    if (logo) {
        setInterval(() => {
            logo.style.transform = 'translateY(-10px)';
            setTimeout(() => {
                logo.style.transform = 'translateY(0)';
            }, 1000);
        }, 2000);
    }
</script>
{% endblock %}